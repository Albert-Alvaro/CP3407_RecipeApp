## Journal of the development process documented from the perspective of Albert Alvaro (14328932)

### 13/3/2024
Today I had started with actually revising my knowledge of Python by reading a Python primer that provided with the refresher I need to get back into the Python development process.I I had initialized the applicaiton section of the django project.Moreover, following the plan which we had created I had started with coding the Django models which are the equivalent to the database schema of typicial SQL databases. I had coded it to be faithful to the source material whihc was the ERD which we had created but there will probably be a need to change the model, however if we do not have to change the models, than we will be satisfied as that would meant hat we had sufficiently planned ahead.

### 19/3/2024
Today I started with actually building the foundation of the app. Firstly I created all fo the views and urls and html templates. The templates I use for this contain only the bare minimum to alow for an easier time in seeing everything work, moreover they are merely a placeholder for when we actually get into the front end design. There are 3 pages which I had created, the uploading page, the image list page, and the result page. The uploading page is where the user will be able to upload the image which they wish to scan, the image list page where the user will eb able to view all of the images which they have uploaded and choose which among them do they wish to select for analyzing, and the resutls page is where the user can view the results of the obejct detection software whcih their image has gone through, the results will be displayed in the form of a list. 

The image detection algorithm used is YOLO, which is able to detect objects within an image with reasonable accuracy and precision. I had managed to integrate the algorithm into the web application relatively smoothly, and it works with no problems.

### 20/3/2024
Today I had refined the output of the algorithm, the algorithm used to just output the individual objects inside of the image, now the objects are counted and shown to the user in a more easily read format, furthermore, the resulting image of the output of the model will be shown as well.

### 23/3/2024

Today, I improved upon the code further. Firstly I fixed some issues in regards to the displayed output image, the output image was being generated into specific directories based on the generated id of the image itself, hwoever the generated directory will not overwrite the previous directory if the user were to analyze the same image twice, meaning the user will only be shown the previous output image instead of the new one, solution for this was to rely on the hope that the user will make use of the web apps navigation flow and click the back button if they want to return to the images page, the back button will delete all of the outputted directories, ensuring that even if the same image is analyzed repeatedly the output image will be the most recent outputted image. Next is the cleaning of the database models, there were remnants of past attempts for trying to sotre the outputted image within the database, but it is unnecessary and was never put inot use, thus although it was not affecting anything, it was better to remvoe it and renew the migrations. 

The next thing I did was to start with the LLM integration, I imported the code from the LLM branch and have only made it into a class for easy importing, I have not implemented it yet today. However I have made it so that after the image of the user has been scanned they can click a button to the next page where they can see a list of the ingredients which they have and the option to also manually add upon what has been detected. 

Fixed another bug where the ingredients will duplicate because everytime it goes back one page it will load int he view of the page as well, causing duplicating ingredients as the page gets reloaded and the same ingredients gets inserted into the database again, and when the next button is hit the thing loads again, causing for there to be duplicated ingredients. Fixed the problem by adjusting and modfying how the pages flow from one another and making the back button in the ingredients page to also delete the output images as well.

I integrated the LLM into the code, it works but the output of the LLM is not formatted, and is hard to read. Need to do more research into how to return the output of the LLM in a way that is similar to how chatGPT does it, line per line maybe?

### 2/4/2024

The past few days to week has been mostly focused on refining and training a YoloV8 model that can fulfill the requirements which the web application demands, specifically the fact that the model just needs to recognize food ingredients and nothing else, thus I have been training a YoloV8 model on an image dataset filled with annotated ingredients which can be used by YoloV8 to train a model. It is slow going, literally, to train a model to any real capacity I would need 5-9 hours. Any lower and the model will just be hallucinating and blind most of the time. I have also fixed some bugs which arose due to the way the forms and objects were initialized in the views.py, this bug made the user have to click teh manual ingredient submit button twice before seeing their ingredient on the list. And the other feature which has been added, is the option to manually add ingredients in the homepage, the user will be able to add ingredients and when they analyze an image, the ingredients detected will simply be added upon the manually entered ingredients at the hoempage, moreover I will be making a way for the user to simply input ingredients and get the LLM output without having to go through the image, currently the user will have to analuyze an image if they want to find a recipe with their manually entered ingredients but that will be fixed and worked on soon enough.

### 3/4/2024

There were some minor and major changes from today. Firstly, the minor changes were the ability for users to now individually delete images stored instead of simply wiping everything with one button, users can now choose which image they want to delete. The major change though is the new feature which allows user to save a recipe which has been generated. The way it works is that a new boolean flag attribute has been created in the recipe entity table, which will indicate whether a recipe is saved or mere temporary. If it is temporary it will be deleted immediately, meanwhile if it is saved, then it will be left alone in the database, the user will then be able to view the saved recipe through an icon that has been placed in the navbar. The debugging, testing, and actual coding of this feature was a major challenge. There were some times where I would have to create several print functions in specific areas just to figure out what exactly is going wrong, moreover, I had also added comments to indicate what section of the views.py does what, which helped significantly reduce my time in searching for specific views. However, in return for the frustration I experienced, I can say for certain that I am more confident in Django then ever.

I have added the feature for users to leave reviews and ratings on their saved recipes, currently users are only able to create on set of review and rating for each saved recipe, users can also view their own reviews and ratings in real time changing, furthermore the formatting issue with the recipes generated has been fixed.

### 4/4/2024

There was a bug in the way in which I was using the sensitive.json file to store my path to the directory which I had wanted to delete. to be precise I had tried to use an if statement to check whether the sensitive.json is a directory, this was a mistake, as sensitive.json is a file, and thus the if statement shall never be accessed. I had only realized this when I had experienced a bug in the image deletion code, images and folders which were supposed to have been deleted are still there, and when I investigated a bit deeper, I had seen that this was the culprit of the bug. A small but very large mistake. Thankfully it has been fixed.

### 6/4/2024

This was a big patch. I had managed to create a rudimentary user account system. Where users are able to register with an account. There are some improvements that definitely needs to be made though. One of them being that the usernames needs to be made unique so that any unnecessary name conflicts can be avoided entirely, passwords being the same is still okay, bad for the user, but not bad for the system, which I will take for now. Each registreed user will have an ID that will be pipedd alongside them from page to page, this ID will serve as the way in which the backend will recognize which user is which within the system. This allows for things like common usernames to exist and not crash the whole thing. But this also makes it so that the if there are two user with the same password and username, then the entry it is authenticated with first from the database will be the user that is logged in, even though it might be the other user, so to fix this issue, making the usernames unique is probably a good idea. Also might want to look into creating a session token system since the IDs of the user are legit just sequenced real numbers.

The account management system worked simply. There is a table that is specifically for storing user data, with attributes such as password and username. whenever a user registers with a password and username, it will be stored in this entity table. When a user wants to log in, it will check with all of the entries within the table and see if the username and password is in the table, if it is then it will let the user into the homepage of the user, denoted by the user id variable being piped in the web page. There are of course issues to this system in regards to cybersecuirty, such as people just being able to type in a url with a number and accessing someones account, or mismatched passwords and usernames being allowed in. But in the context of system engineering it is working, so I will take what I can get. A simple user account system is enough for now.

Also fixed a bug that is related to redirection of users as well, some of the back button and delete functions which used to work just fine needed to be reworked to accomodate for the new user id parameter that is inherent in most pages now. Added some comments as well to hopefully make the code more readable.

### 8/4/2024

Made another major improvement. Managed to get the code to save recipes specifically to a specific account working. Users can now view recipes which are essentially favourited by them. To support this feature, there is also a global recipes list, which is essentially a page filled with all of the recipes created by all of the users, taking both unsaved and saved recipes as well. Users can even save a recipe listed into their own account, currently a recipe can only be saved by one user, but the database infrastructure to support a many to many relationship between recipes and users are already there, it just has not been implemented properly, something which I will do in the future. I have less trouble with this feature than some of the others since I have already laid the ggroundwork and foundation for the creation of a system like this when I had first created the ERD for the database, so I thank my past self for saving me the headache of engineering the whole thing from scratch and trying to implement it now.

The wya the saved recipe works is that in the recipe entity table there is an attribute which acts as a flag to indicate whether a recipe is saved or not, everytime a recipe is saved the flag is changed to indicate that it is indeed saved. This is what currently limits the recipe to being able to be saved by only one user, but in the future I should be able to utilize the bridging table I had already created to improve this. The global recipe page is much easier to create, I simply had to make it so that any recipes created are saved to the database, even the ones flagged as unsaved, and display them in the global recipes page. The way in which a recipe is turned from unsaved to saved is done using a function that will change the bool of the flag attirbute and link it to the user it is saved by via the bridgin table mentioned. The current stopgap solution for the save functionality is truly limiting the web, I wil fix it soon since it is honestly no that difficult of a fix.

### 9/4/2024

Found an error regarding the recipe pages back button, from the global recipe list users are able to select a recipe and find out more about it, the back button should just back them to the homepage or global recipe page, but due to previous piping, it will redirect users to the saved recipe page. Now this I realize is okay if you have recipes saved, if you do not it will just lead you to an empty page, or worse, will crash the system if you are a new user and has an empty entity table in regards to saved recipes. Thus the way this bug was fixed gave me an idea for how to fix the one recipe one user issue as well. The backend will detect whether the queryset which is supposed to contain saved recipes are empty or not, and will pass along a flag that is either true or false based on the condition mentioned. Simple, and efficient, could not believe I had not thought of using such a method beforehand. Fits extremely well with the one recipe one user issue as well. Is definitely possible to rig the backend to determine whether or not a saved recipe is linked to the user or not and send a flag that will determine whether a user should have the option of saving a recipe or not. Will work on such in the future.

### 14/4/2024

Improved upon the code such that it is not reliant on the sensitive.json file to provide a path to the directory which was to be deleted. Increasing the cross device compatibility of the web application by a lot. This was done by simply using functions from the os module to retrieve the current working directory and to string together the path to the directory which is to be deleted. Also improved upon th eflow of the web app as well, users will now not have to click on an image if they want to proceed, if they have already inputtted ingredients and wanted a recipe from just that, they can now simply cliuck next, confirm the ingredients, and get a recipe. This was done by simply adding a next button that will redirect the user to the add or remove ingredients page.

### 15/4/2024

Firstly, made it so that any forms which requires user to input something will be cleared out after they had submitted their input, this is done through reinitializing an empty form after the preivous one's input data has been saved. Also fixed a bug with the delete image button, there was an issue with the piping of variables, the user id and id being mixed up and thus causing an issue with the function, it was fixed by simply adding an id variable to the url of delete image.

### 18/4/2024

Improved upon the save functionality, allowing for a recipe to be saved by multiple users. This was something that could ahve always been done but the previous infrastructure had persisted since it has always worked. but the one recipe one user thing has always beens omething that could have been easily imporved upon, but the priority of it has been lower compared ot the other functions. But now I have finally gotten around to it, and have managed to wire it up in such a way that the bridging table is working as intended, creating a many to many relationship between the users and recipes. The code has finally been updated to utilize this infrastructure to make it so that a recipe can be saved by multiple users.

Usernames are now unique, this is done pretty simply by getting all of the usernames currently in the database, making a list out of it, and checking the username that is going to be registered against the list, notifying th euser that the username already exists if they try to create an account with a pre-existing username.

### 19/4/2024

Improved the ratings and review system by allowing for there to be multiple reviews and ratings to be left on a single recipe. This was done by revamping the entire form of the ratings and reviews, restructuring the database to accomodate a new entity table specifically for reviews, creating a foreign key to link the recipe and the review, fixed a bug in regards to reviews and ratings being saved whenever the page has been refreshed and to add another flag to ensure that the saved recipes tab is still functional, needed since there is already another flag being in used here for the save button.

### 20/4/2024

Ran tests on the web application and fixed any of the bugs which were found during said tests, also refined and improved upon the code as well. Helped with the refinement of the HTML and CSS, and also created and implemented some of the HTML and CSS for several other pages too. 